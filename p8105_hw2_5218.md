p8105_hw2_ml5218
================
Muying Li
2025-09-29

Load packages

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

# Problem 1

## Import & Clea Datasets

Tidy `pols-month.csv`

``` r
pols = 
  read_csv('data/fivethirtyeight_datasets/pols-month.csv') |> 
  janitor::clean_names() |> 
  # break up the variable mon into integer variables year, month, and day
  separate(
    mon, sep="-", into=c("year", "month", "day")
  ) |> 
  # convert into integer variables
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day)
  ) |> 
  # replace month number with month name
  mutate(
    month = case_when(
      month == 1 ~ "January",
      month == 2 ~ "February",
      month == 3 ~ "March",
      month == 4 ~ "April",
      month == 5 ~ "May",
      month == 6 ~ "June",
      month == 7 ~ "July",
      month == 8 ~ "August",
      month == 9 ~ "September",
      month == 10 ~ "October",
      month == 11 ~ "November",
      month == 12 ~ "December"
    )
  ) |> 
  # create a president variable taking values gop and dem
  mutate(
    president = case_when(
      prez_gop > prez_dem ~ "gop",
      prez_dem > prez_gop ~ "dem"
    )
  )|> 
  # remove prez_dem and prez_gop, remove the day variable
  select(-prez_dem, -prez_gop, -day) 
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Tidy `unemployment.csv`

``` r
unemployment = 
  read_csv('data/fivethirtyeight_datasets/unemployment.csv') |> 
  janitor::clean_names() |>
  # tidy the data
  pivot_longer(
    cols = jan:dec,
    names_to = "month",
    values_to = "unemployment_rate"
  ) |> 
  # convert year to integer
  mutate(year = as.integer(year)) |> 
  # replace month abbreviation with month name
  mutate(
    month = case_when(
      month == "jan" ~ "January",
      month == "feb" ~ "February",
      month == "mar" ~ "March",
      month == "apr" ~ "April",
      month == "may" ~ "May",
      month == "jun" ~ "June",
      month == "jul" ~ "July",
      month == "aug" ~ "August",
      month == "sep" ~ "September",
      month == "oct" ~ "October",
      month == "nov" ~ "November",
      month == "dec" ~ "December"
    ),
  ) |>
  # arrange according to year and month
  mutate(month = factor(month, levels = month.name)) |> 
  arrange(year, month) |> 
  # make year and month are the leading columns
  relocate(year, month)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Tidy `snp.csv`

``` r
snp = 
  read_csv('data/fivethirtyeight_datasets/snp.csv') |> 
  janitor::clean_names() |> 
  # break up the variable mon into integer variables year, month, and day
  separate(
    date, sep="/", into=c("month", "day", "year")
  ) |> 
  # convert into integer variables
  mutate(
    year = as.integer(year),
    month = as.integer(month)
  ) |> 
  # replace month number with month name
  mutate(
    month = case_when(
      month == 1 ~ "January",
      month == 2 ~ "February",
      month == 3 ~ "March",
      month == 4 ~ "April",
      month == 5 ~ "May",
      month == 6 ~ "June",
      month == 7 ~ "July",
      month == 8 ~ "August",
      month == 9 ~ "September",
      month == 10 ~ "October",
      month == 11 ~ "November",
      month == 12 ~ "December"
    )
  ) |> 
  # convert year to yyyy format
  mutate(
    year = case_when(
      year <= 25 ~ year+2000,
      year > 25 ~ year+1900
    )
  ) |> 
  # arrange according to year and month
  mutate(month = factor(month, levels = month.name)) |> 
  arrange(year, month) |> 
  # make year and month are the leading columns
  relocate(year, month) |> 
  # remove day 
  select(-day)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

Join the datasets by merging `snp` into `pols`, and merging
`unemployment` into the result.

``` r
result = 
  left_join(pols, snp, by = c("year", "month")) |> 
  left_join(unemployment, by = c("year", "month"))
result
```

    ## # A tibble: 822 × 11
    ##     year month   gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>     <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 January      23      51     253      23      45     198 dem          NA
    ##  2  1947 Februa…      23      51     253      23      45     198 dem          NA
    ##  3  1947 March        23      51     253      23      45     198 dem          NA
    ##  4  1947 April        23      51     253      23      45     198 dem          NA
    ##  5  1947 May          23      51     253      23      45     198 dem          NA
    ##  6  1947 June         23      51     253      23      45     198 dem          NA
    ##  7  1947 July         23      51     253      23      45     198 dem          NA
    ##  8  1947 August       23      51     253      23      45     198 dem          NA
    ##  9  1947 Septem…      23      51     253      23      45     198 dem          NA
    ## 10  1947 October      23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment_rate <dbl>

## Description about the Datasets

Basic summary

``` r
# dimensions of the dataset
dim(result)
# structure of the dataset
str(result)
# missing values
colSums(is.na(result))
# summary statistics
summary(result)
```

*Write a short paragraph about these datasets. Explain briefly what each
dataset contained, and describe the resulting dataset (e.g. give the
dimension, range of years, and names of key variables).*

### `pols`

`pols` (from `pols-month.csv`) contains 822 observations of 9 variables
related to the number of national politicians who are democratic or
republican in a specific month of the associated year from 1947 to 2015:

- `year`: year of the count on that row
- `month`: month of the count on that row
- `gov_gop`, `sen_gop`, `rep_gop`: the number of Republican Party
  representatives in government, Senate, and House, respectively on the
  associated month and year
- `gov_dem`, `sen_dem`, `rep_dem`: the number of Democratic Party
  representatives in government, Senate, and House, respectively on the
  associated month and year
- `president`: political affiliation of the U.S. president on the
  associated month and year (`dem` = democratic, `gop` = republican)

This dataset contains 0, 0, 0, 0, 0, 0, 0, 0, 0 missing values in
columns year, month, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem,
rep_dem, president respectively, indicating no missing values.

### `unemployment`

`unemployment` (from `unemployment.csv`) contains 816 observations of 3
variables related to percentage of unemployment in a specific month of
the associated year from 1948 to 2015:

- `year`: year of the measurements on that row
- `month`: month of the count on that row
- `unemployment_rate`: percentage of unemployment of the associated year
  and month

However, this dataset contains 0, 0, 6 missing values in columns year,
month, unemployment_rate respectively, corresponding to no records of
unemployment rate from July 2015 to December 2015.

### `snp`

`snp` (from `snp.csv`) contains 787 observations of 3 variables related
to Standard & Poor’s stock market index (S&P) in a specific month of the
associated year from 1950 to 2015:

- `year`: year of the measurements on that row
- `month`: month of the measurements on that row
- `close`: the closing values of the S&P stock index on the associated
  year and month

This dataset contains 0, 0, 0 missing values in columns year, month,
close respectively, indicating no missing values.

### Merged dataset `result`

`result` includes merged data from `unemployment` and `snp` into `pols`.
Therefore, it contains information on political party representation,
the closing values of the S&P stock index, and the percentage of
unemployment, from January 1947 to June 2015 (same range as `pols`). It
includes a total of 822 rows/observations and 11 columns/variables as
described above.

# Problem 2

## Import & Clean data for Professor Trash Wheel and Gwynnda

Mr. Trash Wheel

``` r
mr_trash = 
  read_excel(
    "data/202409 Trash Wheel Collection Data.xlsx", 
    sheet = "Mr. Trash Wheel",
    range = "A2:N653"
    ) |> 
  janitor::clean_names() |> 
  # no need date
  select(-date) |> 
  # add name of the wheel
  mutate(
    wheel = "mr"
  ) |> 
  # round sports balls to the nearest integer and converts the result to an integer variable 
  mutate(sports_balls = as.integer(round(sports_balls))) |> 
  # pivot the data longer for types of trash
  pivot_longer(
    cols = plastic_bottles:sports_balls,
    names_to = "trash_type",
    values_to = "count"
  ) |> 
  # pivot the data longer for weight and volume 
  pivot_longer(
    cols = weight_tons:volume_cubic_yards,
    names_to = "measurement_type",
    values_to = "value"
  ) |> 
  # move homes to the last column 
  relocate(homes_powered, .after = last_col()) |> 
  # convert year and month to integer and factor
  mutate(
    month = str_to_title(month),
    month = factor(month, levels = month.name),
    year = as.integer(year)
  )
mr_trash
```

    ## # A tibble: 9,114 × 9
    ##    dumpster month  year wheel trash_type       count measurement_type   value
    ##       <dbl> <fct> <int> <chr> <chr>            <dbl> <chr>              <dbl>
    ##  1        1 May    2014 mr    plastic_bottles   1450 weight_tons         4.31
    ##  2        1 May    2014 mr    plastic_bottles   1450 volume_cubic_yards 18   
    ##  3        1 May    2014 mr    polystyrene       1820 weight_tons         4.31
    ##  4        1 May    2014 mr    polystyrene       1820 volume_cubic_yards 18   
    ##  5        1 May    2014 mr    cigarette_butts 126000 weight_tons         4.31
    ##  6        1 May    2014 mr    cigarette_butts 126000 volume_cubic_yards 18   
    ##  7        1 May    2014 mr    glass_bottles       72 weight_tons         4.31
    ##  8        1 May    2014 mr    glass_bottles       72 volume_cubic_yards 18   
    ##  9        1 May    2014 mr    plastic_bags       584 weight_tons         4.31
    ## 10        1 May    2014 mr    plastic_bags       584 volume_cubic_yards 18   
    ## # ℹ 9,104 more rows
    ## # ℹ 1 more variable: homes_powered <dbl>

``` r
filter(mr_trash, is.na(year) | is.na(month))
```

    ## # A tibble: 0 × 9
    ## # ℹ 9 variables: dumpster <dbl>, month <fct>, year <int>, wheel <chr>,
    ## #   trash_type <chr>, count <dbl>, measurement_type <chr>, value <dbl>,
    ## #   homes_powered <dbl>

Professor Trash Wheel

``` r
prof_trash = 
  read_excel(
    "data/202409 Trash Wheel Collection Data.xlsx", 
    sheet = "Professor Trash Wheel",
    range = "A2:M121"
    ) |> 
  janitor::clean_names() |> 
  # no need date
  select(-date) |> 
  # add name of the wheel
  mutate(
    wheel = "prof"
  ) |> 
  # pivot the data longer for types of trash
  pivot_longer(
    cols = plastic_bottles:wrappers,
    names_to = "trash_type",
    values_to = "count"
  ) |> 
  # pivot the data longer for weight and volume 
  pivot_longer(
    cols = weight_tons:volume_cubic_yards,
    names_to = "measurement_type",
    values_to = "value"
  ) |> 
  # move homes to the last column 
  relocate(homes_powered, .after = last_col()) |> 
  # convert year and month to integer and factor
  mutate(
    month = str_to_title(month),
    month = factor(month, levels = month.name),
    year = as.integer(year)
  ) |> 
  # only keep non-empty rows
  filter(!is.na(year))

prof_trash
```

    ## # A tibble: 1,416 × 9
    ##    dumpster month    year wheel trash_type      count measurement_type   value
    ##       <dbl> <fct>   <int> <chr> <chr>           <dbl> <chr>              <dbl>
    ##  1        1 January  2017 prof  plastic_bottles  1950 weight_tons         1.79
    ##  2        1 January  2017 prof  plastic_bottles  1950 volume_cubic_yards 15   
    ##  3        1 January  2017 prof  polystyrene      6080 weight_tons         1.79
    ##  4        1 January  2017 prof  polystyrene      6080 volume_cubic_yards 15   
    ##  5        1 January  2017 prof  cigarette_butts 19700 weight_tons         1.79
    ##  6        1 January  2017 prof  cigarette_butts 19700 volume_cubic_yards 15   
    ##  7        1 January  2017 prof  glass_bottles       8 weight_tons         1.79
    ##  8        1 January  2017 prof  glass_bottles       8 volume_cubic_yards 15   
    ##  9        1 January  2017 prof  plastic_bags     3100 weight_tons         1.79
    ## 10        1 January  2017 prof  plastic_bags     3100 volume_cubic_yards 15   
    ## # ℹ 1,406 more rows
    ## # ℹ 1 more variable: homes_powered <dbl>

Gwynnda

``` r
gwy_trash = 
  read_excel(
    "data/202409 Trash Wheel Collection Data.xlsx", 
    sheet = "Gwynnda Trash Wheel",
    range = "A2:L265"
    ) |> 
  janitor::clean_names() |> 
  # no need date
  select(-date) |> 
  # add name of the wheel
  mutate(
    wheel = "gwy"
  ) |> 
  # pivot the data longer for types of trash
  pivot_longer(
    cols = plastic_bottles:wrappers,
    names_to = "trash_type",
    values_to = "count"
  ) |> 
  # pivot the data longer for weight and volume 
  pivot_longer(
    cols = weight_tons:volume_cubic_yards,
    names_to = "measurement_type",
    values_to = "value"
  ) |> 
  # move homes to the last column 
  relocate(homes_powered, .after = last_col()) |> 
  # convert year and month to integer and factor
  mutate(
    month = str_to_title(month),
    month = factor(month, levels = month.name),
    year = as.integer(year)
  )
gwy_trash
```

    ## # A tibble: 2,630 × 9
    ##    dumpster month  year wheel trash_type      count measurement_type   value
    ##       <dbl> <fct> <int> <chr> <chr>           <dbl> <chr>              <dbl>
    ##  1        1 July   2021 gwy   plastic_bottles  1200 weight_tons         0.93
    ##  2        1 July   2021 gwy   plastic_bottles  1200 volume_cubic_yards 15   
    ##  3        1 July   2021 gwy   polystyrene       360 weight_tons         0.93
    ##  4        1 July   2021 gwy   polystyrene       360 volume_cubic_yards 15   
    ##  5        1 July   2021 gwy   cigarette_butts  3400 weight_tons         0.93
    ##  6        1 July   2021 gwy   cigarette_butts  3400 volume_cubic_yards 15   
    ##  7        1 July   2021 gwy   plastic_bags     1800 weight_tons         0.93
    ##  8        1 July   2021 gwy   plastic_bags     1800 volume_cubic_yards 15   
    ##  9        1 July   2021 gwy   wrappers           NA weight_tons         0.93
    ## 10        1 July   2021 gwy   wrappers           NA volume_cubic_yards 15   
    ## # ℹ 2,620 more rows
    ## # ℹ 1 more variable: homes_powered <dbl>

Combine this with the 3 wheel datasets

``` r
wheels = 
  bind_rows(mr_trash, prof_trash, gwy_trash) |> 
  # move wheel, year, month as leading columns 
  relocate(wheel, year, month)
```

## Description about `wheels`

*Write a paragraph about these data; you are encouraged to use inline R.
Be sure to note the number of observations in the resulting dataset, and
give examples of key variables.*

The `wheels` contains trash collection data of 3 wheels: Mr. Trash
Wheel, Professor Trash Wheel, and Gwynnda Trash Wheel, from 2014 to
2024. It includes a total of 13160 observations of 9 variables. Each
row/observation indicates the trash collection information of a specific
wheel’s dumpster in a month and a year such as amount of total litter
and litter type, and number of homes powered by the trash collected.

Key variables include:

- `wheel`: wheel identifier indicating which wheel the trash was
  collected from (`mr` = Mr. Trash, `prof` = Professor, `gwy` = Gwynnda)
- `year`: year the data was collected
- `month`: month the data was collected
- `dumpster`: dumpster number (in integer, starting from 1)
- `trash_type`: type of trash collected, including `plastic_bottles`,
  `polystyrene`, `cigarette_butts`, `glass_bottles`, `plastic_bags`,
  `wrappers`, `sports_balls`
- `count`: counts of how many of a specific trash type was collected (in
  integer)
- `measurement_type`: type of measurement of total trash collected (such
  as weight in tons (`weight_tons`) or volume in cubic yards
  (`volume_cubic_yards`))
- `value`: numeric value of a specific measurement type of total trash
  collected

*What was the total weight of trash collected by Professor Trash Wheel?*

``` r
prof_total_weight = 
  filter(
    wheels, 
    wheel == "prof", 
    measurement_type == "weight_tons"
  ) |> 
  select(value) |> 
  sum()
```

The total weight of trash collected by Professor Trash Wheel is 1480.44
tons.

*What was the total number of cigarette butts collected by Gwynnda in
June of 2022?*

``` r
gwy_jun22_cig = 
  filter(
    wheels, 
    wheel == "gwy", 
    trash_type == "cigarette_butts",
    year == 2022,
    month == "June"
  ) |> 
  select(count) |> 
  sum()
```

The total number of cigarette butts collected by Gwynnda in June of 2022
is 3.624^{4}.

# Question

1.  no dumpster
2.  left_join prob1?
