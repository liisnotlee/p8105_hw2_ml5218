---
title: "p8105_hw2_ml5218"
author: "Muying Li"
date: "2025-09-29"
output: github_document
---


Load packages
```{r}
library(tidyverse)
```

# Problem 1

## Loading & Cleaning Datasets 
Tidy `pols-month.csv`
```{r}
pols = 
  read_csv('fivethirtyeight_datasets/pols-month.csv') |> 
  janitor::clean_names() |> 
  # break up the variable mon into integer variables year, month, and day
  separate(
    mon, sep="-", into=c("year", "month", "day")
  ) |> 
  # convert into integer variables
  mutate(
    year = as.integer(year),
    month = as.integer(month),
    day = as.integer(day)
  ) |> 
  # replace month number with month name
  mutate(
    month = case_when(
      month == 1 ~ "January",
      month == 2 ~ "February",
      month == 3 ~ "March",
      month == 4 ~ "April",
      month == 5 ~ "May",
      month == 6 ~ "June",
      month == 7 ~ "July",
      month == 8 ~ "August",
      month == 9 ~ "September",
      month == 10 ~ "October",
      month == 11 ~ "November",
      month == 12 ~ "December"
    )
  ) |> 
  # create a president variable taking values gop and dem
  mutate(
    president = case_when(
      prez_gop > prez_dem ~ "gop",
      prez_dem > prez_gop ~ "dem"
    )
  )|> 
  # remove prez_dem and prez_gop, remove the day variable
  select(-prez_dem, -prez_gop, -day) 
```
Tidy `unemployment.csv`
```{r}
unemployment = 
  read_csv('fivethirtyeight_datasets/unemployment.csv') |> 
  janitor::clean_names() |>
  # tidy the data
  pivot_longer(
    cols = jan:dec,
    names_to = "month",
    values_to = "unemployment_rate"
  ) |> 
  # convert year to integer
  mutate(year = as.integer(year)) |> 
  # replace month abbreviation with month name
  mutate(
    month = case_when(
      month == "jan" ~ "January",
      month == "feb" ~ "February",
      month == "mar" ~ "March",
      month == "apr" ~ "April",
      month == "may" ~ "May",
      month == "jun" ~ "June",
      month == "jul" ~ "July",
      month == "aug" ~ "August",
      month == "sep" ~ "September",
      month == "oct" ~ "October",
      month == "nov" ~ "November",
      month == "dec" ~ "December"
    ),
  ) |>
  # arrange according to year and month
  mutate(month = factor(month, levels = month.name)) |> 
  arrange(year, month) |> 
  # make year and month are the leading columns
  relocate(year, month)
```
Tidy `snp.csv`
```{r}
snp = 
  read_csv('fivethirtyeight_datasets/snp.csv') |> 
  janitor::clean_names() |> 
  # break up the variable mon into integer variables year, month, and day
  separate(
    date, sep="/", into=c("month", "day", "year")
  ) |> 
  # convert into integer variables
  mutate(
    year = as.integer(year),
    month = as.integer(month)
  ) |> 
  # replace month number with month name
  mutate(
    month = case_when(
      month == 1 ~ "January",
      month == 2 ~ "February",
      month == 3 ~ "March",
      month == 4 ~ "April",
      month == 5 ~ "May",
      month == 6 ~ "June",
      month == 7 ~ "July",
      month == 8 ~ "August",
      month == 9 ~ "September",
      month == 10 ~ "October",
      month == 11 ~ "November",
      month == 12 ~ "December"
    )
  ) |> 
  # convert year to yyyy format
  mutate(
    year = case_when(
      year <= 25 ~ year+2000,
      year > 25 ~ year+1900
    )
  ) |> 
  # arrange according to year and month
  mutate(month = factor(month, levels = month.name)) |> 
  arrange(year, month) |> 
  # make year and month are the leading columns
  relocate(year, month) |> 
  # remove day 
  select(-day)
```

Join the datasets by merging `snp` into `pols`, and merging `unemployment` into the result.
```{r}
result = 
  left_join(pols, snp, by = c("year", "month")) |> 
  left_join(unemployment, by = c("year", "month"))
result
```

## Description about the Datasets
Basic summary
```{r eval = FALSE}
# dimensions of the dataset
dim(result)
# structure of the dataset
str(result)
# missing values
colSums(is.na(result))
# summary statistics
summary(result)
```

*Write a short paragraph about these datasets. Explain briefly what each dataset contained, and describe the resulting dataset (e.g. give the dimension, range of years, and names of key variables).*

### `pols`
`pols` (from `pols-month.csv`) contains `r nrow(pols)` observations of `r ncol(pols)` variables related to the number of national politicians who are democratic or republican in a specific month of the associated year from `r min(pols$year)` to `r max(pols$year)`:

- `year`: year of the count on that row
- `month`: month of the count on that row
- `gov_gop`, `sen_gop`, `rep_gop`: the number of Republican Party representatives in government, Senate, and House, respectively on the associated month and year
- `gov_dem`, `sen_dem`, `rep_dem`: the number of Democratic Party representatives in government, Senate, and House, respectively on the associated month and year
- `president`: political affiliation of the U.S. president on the associated month and year (`dem` = democratic, `gop` = republican)

This dataset contains `r colSums(is.na(pols))` missing values in columns `r colnames(pols)` respectively, indicating no missing values. 


### `unemployment`
`unemployment` (from `unemployment.csv`) contains `r nrow(unemployment)` observations of `r ncol(unemployment)` variables related to percentage of unemployment in a specific month of the associated year from `r min(unemployment$year)` to `r max(unemployment$year)`:

- `year`: year of the measurements on that row
- `month`: month of the count on that row
- `unemployment_rate`: percentage of unemployment of the associated year and month

However, this dataset contains `r colSums(is.na(unemployment))` missing values in columns `r colnames(unemployment)` respectively, corresponding to no records of unemployment rate from July 2015 to December 2015. 


### `snp`
`snp` (from `snp.csv`) contains `r nrow(snp)` observations of `r ncol(snp)` variables related to  Standard & Poorâ€™s stock market index (S&P) in a specific month of the associated year from `r min(snp$year)` to `r max(snp$year)`:

- `year`: year of the measurements on that row
- `month`: month of the measurements on that row
- `close`: the closing values of the S&P stock index on the associated year and month

This dataset contains `r colSums(is.na(snp))` missing values in columns `r colnames(snp)` respectively, indicating no missing values. 


### Merged dataset `result`
`result` includes merged data from `unemployment` and `snp` into `pols`. Therefore, it contains information on political party representation, the closing values of the S&P stock index, and the percentage of unemployment, from January 1947 to June 2015 (same range as `pols`). It includes a total of `r nrow(result)` rows/observations and `r ncol(result)` columns/variables as described above. 

